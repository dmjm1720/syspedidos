<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">

<body>

	<ui:composition template="/Template/Template.xhtml">
		<ui:define name="top">

		</ui:define>


		<ui:define name="content">
			<h2>MIS PEDIDOS</h2>
			<!--Formulario para las cotizaciones-->
			<h:form id="frmPedidos">
				<p:growl id="msg" autoUpdate="true" showDetail="true" life="6000"
					showSummary="true" />

				<p:panel header="" style="margin: 0 auto;">

					<br></br>
					<br></br>
					<p:divider style="height: 2px" />
					<div style="text-align: center">
						<p:outputLabel value="LISTA DE PEDIDOS DE CLIENTES"
							style="font-weight: bold; color: #1E90FF" />
					</div>
					<p:divider style="height: 2px" />
					<p:dataTable id="tblCotizaciones" var="item" editable="true"
						rowIndexVar="index" size="small"
						value="#{factSaeBean.listaFacturasEncabezadosClientesVentas}"
						styleClass="textoCentrado" sortMode="multiple" scrollHeight="650"
						scrollWidth="99%"
						currentPageReportTemplate="Total pedidos:#{factSaeBean.listaFacturasEncabezadosClientesVentas.size()}"
						paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						rowsPerPageTemplate="50,100,200,500" rows="50" paginator="true"
						rowHover="true" paginatorAlwaysVisible="true" scrollable="true"
						emptyMessage="No hay registros...">

						<p:column headerText="DETALLE" style="width: 10rem"
							styleClass="textoCentrado">
							<p:commandButton value="Ver detalle" styleClass="ui-button-info"
								icon="fa-solid fa-circle-info" action="#{factSaeBean.listarPartidasPedidos(item.cve_doc)}"
								oncomplete="PF('dlgDetalle').show();"
								update="frmPedidos:tblDetalle">
							</p:commandButton>
						</p:column>

						<p:column headerText="IMPRIMIR" style="width: 10rem"
							styleClass="textoCentrado">
							<p:commandButton value="Imprimir" styleClass="ui-button-warning"
								icon="fa-solid fa-print" actionListener="#{factSaeBean.listarEtiquetas(item.cve_doc)}">
							</p:commandButton>
						</p:column>
						<p:column headerText="CLAVE CLIENTE" filterBy="#{item.clave}" sortBy="#{item.clave}"
							style="width: 6rem;" styleClass="textoCentrado">
							<h:outputText value="#{item.clave}" />
						</p:column>

						<p:column headerText="NOMBRE" filterBy="#{item.nombre}" sortBy="#{item.nombre}"
							style="width: 15rem" styleClass="textoCentrado">
							<h:outputText value="#{item.nombre}" />
						</p:column>

						<p:column headerText="RFC" filterBy="#{item.rfc}" sortBy="#{item.rfc}"
							style="width: 10rem" styleClass="textoCentrado">
							<h:outputText value="#{item.rfc}" />
						</p:column>

						<p:column headerText="NO. PEDIDO" filterBy="#{item.cve_doc}"
							style="width: 6rem" styleClass="textoCentrado">
							<h:outputText value="#{item.cve_doc}" />
						</p:column>

						<p:column headerText="ESTATUS" filterBy="#{item.estatus}" sortBy="#{item.estatus}"
							style="width: 10rem" styleClass="textoCentrado">
							<h:outputText value="#{item.estatus}" />
						</p:column>

						<p:column headerText="FECHA" filterBy="#{item.fecha_ent}"
							style="width: 10rem">
							<h:outputText value="#{item.fecha_ent}" />
						</p:column>

						<p:column headerText="FECHA VENCIMIENTO"
							filterBy="#{item.fecha_ven}" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.fecha_ven}" />
						</p:column>

						<p:column headerText="FECHA CANCELACIÓN"
							filterBy="#{item.fecha_cancela}" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.fecha_cancela}" />
						</p:column>

						<p:column headerText="SUBTOTAL" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.can_tot}">
								<f:convertNumber type="currency" currencySymbol="$"
									locale="en_US" groupingUsed="true" maxFractionDigits="2" />
							</h:outputText>
						</p:column>

						<p:column headerText="DESCUENTO" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.des_tot}">
								<f:convertNumber type="currency" currencySymbol="$"
									locale="en_US" groupingUsed="true" maxFractionDigits="2" />
							</h:outputText>
						</p:column>

						<p:column headerText="IVA" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.imp_tot4}">
								<f:convertNumber type="currency" currencySymbol="$"
									locale="en_US" groupingUsed="true" maxFractionDigits="2" />
							</h:outputText>
						</p:column>

						<p:column headerText="TOTAL" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.importe}">
								<f:convertNumber type="currency" currencySymbol="$"
									locale="en_US" groupingUsed="true" maxFractionDigits="2" />
							</h:outputText>
						</p:column>

						<p:column headerText="MÉTODO DE PAGO" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.metopago}" />
						</p:column>

						<p:column headerText="Tipo de documento anterior"
							style="width: 10rem" styleClass="textoCentrado">
							<h:outputText value="#{item.tip_doc_ant}" />
						</p:column>

						<p:column headerText="Documento anterior" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.doc_ant}" />
						</p:column>

						<p:column headerText="Tipo de documento siguiente"
							style="width: 10rem">
							<h:outputText value="#{item.tip_doc_sig}" />
						</p:column>
						<p:column headerText="Documento siguiente" style="width: 10rem"
							styleClass="textoCentrado">
							<h:outputText value="#{item.doc_sig}" />
						</p:column>


					</p:dataTable>

					<p:dialog header="DETALLE DEL PEDIDO" widgetVar="dlgDetalle"
						showEffect="explode" hideEffect="slide" closeOnEscape="true"
						minimizable="true" maximizable="true">
						<p:dataTable id="tblDetalle" var="item" editable="true"
							rowIndexVar="index" size="small"
							value="#{factSaeBean.listarPartidasCotizaciones}"
							style="font-size: .9rem;" sortMode="multiple" scrollHeight="650"
							scrollWidth="60%"
							currentPageReportTemplate="Total partidas:#{factSaeBean.listarPartidasCotizaciones.size()}"
							paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							rowsPerPageTemplate="50,100,200,500" rows="50" paginator="true"
							liveScroll="true" rowHover="true" paginatorAlwaysVisible="true"
							scrollable="true" emptyMessage="Ningún artículo agregado...">

							<p:column headerText="PEDIDO NO." style="width: 5rem">
								<h:outputText value="#{item.cve_doc}" />
							</p:column>

							<p:column headerText="CLAVE ARTÍCULO" style="width: 6rem">
								<h:outputText value="#{item.cve_art}" />
							</p:column>

							<p:column headerText="DESCRIPCIÓN" style="width: 20rem">
								<h:outputText value="#{item.descr}" />
							</p:column>

							<p:column headerText="U/M" style="width: 4rem">
								<h:outputText value="#{item.uni_med}" />
							</p:column>
							<p:column headerText="CANTIDAD" style="width: 4rem">
								<h:outputText value="#{item.cant}" />
							</p:column>
							<p:column headerText="PRECIO" style="width: 4rem">
								<h:outputText value="#{item.prec}" />
							</p:column>
							<p:column headerText="TOTAL" style="width: 4rem">
								<h:outputText value="#{item.impu4}" />
							</p:column>
							<p:column headerText="DESCUENTO" style="width: 5rem">
								<h:outputText value="#{item.desc1}" />
							</p:column>
							<p:column headerText="TOTAL PARTIDA" style="width: 4rem">
								<h:outputText value="#{item.tot_partida}" />
							</p:column>

						</p:dataTable>
					</p:dialog>

					<div style="text-align: center"></div>
				</p:panel>

			</h:form>
			<!--Formulario para las cotizaciones-->

		</ui:define>

		<ui:define name="bottom">

		</ui:define>

	</ui:composition>

</body>
</html>
